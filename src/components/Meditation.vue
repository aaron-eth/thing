<template>
  <div id="app">
    <div :style="{animationDuration: duration + 's'}" id="mediContainer">
      <aplayer autoplay 
        :music="{
          title: 'meditation',
          src: sound
        }"
      />
      <div :style="{animationDuration: duration + 's'}" id="circle">
      </div>
      <div :style="{animationDuration: duration/2 + 's'}" id="message">
        {{message}}<br>{{timeLeft}} s
      </div>
    </div>
  </div>
</template>

<script>
import Aplayer from 'vue-aplayer'
import Vuex from '../store/index.js'

export default {
  data(){
    return{
      message: "breathe in",
      duration: Vuex.state.meditationType,
      sound: Vuex.state.meditationSound + ".mp3",
      timeLeft: Vuex.state.meditationDuration,
      }
  },
  components: {
    Aplayer
  },
 methods: {
  changeMsg() {
    if (this.message === 'breathe in') {
      this.message = 'breathe out';
    } else {
      this.message = 'breathe in';
    }
    setTimeout(this.changeMsg, this.duration / 2 * 1000);
  },
  changeDur() {
    if (this.timeLeft === 0) {
      clearInterval(this.intervalId);
    } else {
      this.timeLeft--;
    }
    setTimeout(this.changeDur, 1000);
  }
},
created() {
  document.body.style.background = 'black';

  this.changeDur()
  this.changeMsg();
}
}  
  
</script>

<style>
#mediContainer{
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  position: absolute;
  animation-name: backgroundChange;
  animation-iteration-count: infinite;
}
@keyframes backgroundChange {
  0% {background-color: black}
  35%, 65% {background-color: #000f33}
  100% {background-color: black}
}

#circle{
  margin: auto;
  margin-top: 19%;
  width: fit-content;
  background: linear-gradient(180deg, #ff4d4d, #90b1ff);
  background-size: 400% 400%;
  border-radius: 50%;
  padding: 80px;
  box-shadow: 2px 2px 14px black;
  animation-name: circle;
  animation-iteration-count: infinite;
}
@keyframes circle{
  0% {transform: scale(0.1);background-position:50% 100%}
  30%, 70% {background-position:50% 100%}
  50% {transform: scale(1); background-position:50% 0%}
  100% {transform: scale(0.1);background-position:50% 100%}
}

#message{
  font-family: 'Source Sans Pro', sans-serif;
  font-size: 34px;
  margin-top: 4%;
  animation-name: message;
  animation-iteration-count: infinite;
}
@keyframes message{
  0% {opacity: 0}
  30% {opacity: 1}
  70% {opacity: 1}
  100% {opacity: 0}
}

#back{
  top: 2%;
  left: 2%;
  position: fixed;
  margin: auto;
  padding: 5px;
  border: 1px solid floralwhite;
  border-radius: 5px;
}
  
</style>